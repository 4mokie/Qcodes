

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>QCoDeS Example with Tektronix AWG5014 &mdash; QCoDeS 0.1.7 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="QCoDeS 0.1.7 documentation" href="../../index.html"/>
        <link rel="up" title="Examples of using QCoDeS" href="../../examples/index.html"/>
        <link rel="next" title="Qcodes example with Triton" href="Qcodes example with Triton.html"/>
        <link rel="prev" title="QCoDeS Example with Tektronix TPS2012" href="Qcodes example with TPS2012.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> QCoDeS
          

          
          </a>

          
            
            
              <div class="version">
                0.1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/index.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../help.html">Get Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Classes and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/generated/qcodes.instrument_drivers.html">qcodes.instrument_drivers package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Qcodes project plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes/index.html">Changelogs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../examples/index.html">Examples of using QCoDeS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#basic-examples">Basic examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../examples/index.html#drivers">Drivers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="QCodes example with SR830.html">QCoDeS example with SR830</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example ATS_ONWORK.html">Qcodes example ATS_ONWORK</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with AMI430.html">QCoDeS example with AMI430</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Agilent 34400A.html">Qcodes example with Agilent 34400A</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Decadac.html">Qcodes example with Decadac</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Ithaco.html">Qcodes example with Ithaco</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Keithley 2600.html">Qcodes example with Keithley 2600</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Keysight 33500B.html">Qcodes example with Keysight 33500B</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Keysight Infiniium Oscilloscope.html">Example Notebook for Keysight Infiniium Oscilloscopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Mercury IPS (Magnet).html">Qcodes example with Mercury IPS (Magnet)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with QDac.html">Qcodes example with QDac</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with QDac_channels.html">Qcodes example with QDac_channels</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Rohde Schwarz RTO 1000 series Oscilloscope.html">Qcodes example with Rohde Schwarz RTO 1000 series Oscilloscope</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Rohde Schwarz ZNB.html">Qcodes example with Rohde Schwarz ZN20/8</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with TPS2012.html">QCoDeS Example with Tektronix TPS2012</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">QCoDeS Example with Tektronix AWG5014</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#table-of-contents">Table of contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="#imports-and-initialisation">Imports and initialisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sending-waveforms">SENDING WAVEFORMS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-awg-in-lazy-mode">Running the AWG in “lazy” mode</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with Triton.html">Qcodes example with Triton</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qcodes example with ZI UHF-LI.html">QCoDeS Example with ZI UHF-LI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#benchmarking">Benchmarking</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QCoDeS</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../examples/index.html">Examples of using QCoDeS</a> &raquo;</li>
        
      <li>QCoDeS Example with Tektronix AWG5014</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/_notebooks/driver_examples/Qcodes example with Tektronix AWG5014C.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="qcodes-example-with-tektronix-awg5014">
<h1>QCoDeS Example with Tektronix AWG5014<a class="headerlink" href="#qcodes-example-with-tektronix-awg5014" title="Permalink to this headline">¶</a></h1>
<div class="section" id="table-of-contents">
<h2>Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="#init">Imports and initialisation</a></li>
<li><a class="reference external" href="#sending">Sending waveforms</a></li>
<li><a class="reference external" href="#viaawg">Via an .awg-file</a></li>
<li><a class="reference external" href="#tolist">Sending directly to list</a></li>
<li><a class="reference external" href="#lazy">Running in “lazy” mode</a></li>
</ul>
</div>
<div class="section" id="imports-and-initialisation">
<h2>Imports and initialisation<a class="headerlink" href="#imports-and-initialisation" title="Permalink to this headline">¶</a></h2>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">nbagg</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">qcodes.instrument_drivers.tektronix.AWG5014</span> <span class="k">as</span> <span class="nn">awg</span>  <span class="c1"># &lt;--- The instrument driver</span>
<span class="kn">from</span> <span class="nn">qcodes.instrument_drivers.tektronix.AWGFileParser</span> <span class="k">import</span> <span class="n">parse_awg_file</span>  <span class="c1"># &lt;--- A helper function</span>

<span class="n">awg1</span> <span class="o">=</span> <span class="n">awg</span><span class="o">.</span><span class="n">Tektronix_AWG5014</span><span class="p">(</span><span class="s1">&#39;AWG1&#39;</span><span class="p">,</span> <span class="s1">&#39;TCPIP0::172.20.3.57::inst0::INSTR&#39;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Note: if you have had any initialisation problems, the VISA message queue of the instrument could be fouled up</span>
<span class="c1">#(e.g. if the cell above gave you back something like &#39;Connected to: 1.20000000E+009 ...&#39;)</span>
<span class="c1"># in that case, run the following command to reset the message queue</span>
<span class="n">awg1</span><span class="o">.</span><span class="n">clear_message_queue</span><span class="p">()</span>
</pre></div>
</div>
<p>As with any other QCoDeS instrument, parameters can be set and get
(gotten).</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">awg1</span><span class="o">.</span><span class="n">ch3_state</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">awg1</span><span class="o">.</span><span class="n">ch2_offset</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
<span class="n">awg1</span><span class="o">.</span><span class="n">ch2_offset</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">awg1</span><span class="o">.</span><span class="n">ch2_offset</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</pre></div>
</div>
<p>A list of all available parameters can be found in the following manner:</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">pars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">awg1</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">pars</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">,</span> <span class="n">awg1</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="sending-waveforms">
<h2>SENDING WAVEFORMS<a class="headerlink" href="#sending-waveforms" title="Permalink to this headline">¶</a></h2>
<p>There are two supported ways of sending waveforms to the AWG; by making
an .awg file, sending and loading that, or by sending waveforms to the
User Defined list one by one and putting them in the sequencer. The
first method is generally faster.</p>
<div class="section" id="making-some-waveforms">
<h3>MAKING SOME WAVEFORMS<a class="headerlink" href="#making-some-waveforms" title="Permalink to this headline">¶</a></h3>
<p>First, we make a handful of pulse shapes and marker signals to send to
the AWG. This should be done with numpy arrays.</p>
<p>Please note that the waveforms must <strong>not</strong> have values exceeding -1 to
1, and that the markers must <strong>only</strong> have values 0 or 1. Otherwise the
AWG misinterprets the signals.</p>
<p>In this example, we only use two channels of the AWG, namely channel 1
and 3. Extending to one or more should be straightforward.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">noofseqelems</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">noofpoints</span> <span class="o">=</span> <span class="mi">1200</span>
<span class="n">waveforms</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[]]</span>  <span class="c1"># one list for each channel</span>
<span class="n">m1s</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[]]</span>
<span class="n">m2s</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[]]</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">noofseqelems</span><span class="p">):</span>
    <span class="c1"># waveform and markers for channel 1</span>
    <span class="n">waveforms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">noofpoints</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">hanning</span><span class="p">(</span><span class="n">noofpoints</span><span class="p">))</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">noofpoints</span><span class="p">)</span>
    <span class="n">m1</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">noofpoints</span><span class="o">/</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">))]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">m1s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">noofpoints</span><span class="p">)</span>
    <span class="n">m2s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span>

    <span class="c1"># waveform and markers for channel two</span>
    <span class="n">wf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">noofpoints</span><span class="p">))</span>
    <span class="n">wf</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">noofpoints</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span>
    <span class="n">waveforms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">noofpoints</span><span class="p">)</span>
    <span class="n">m1</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">noofpoints</span><span class="o">/</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">))]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">m1s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">noofpoints</span><span class="p">)</span>
    <span class="n">m2s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="c1"># We can visualise the waveforms and markers</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Channel 1 waveform&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Channel 1 markers&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Channel 3 waveform&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Channel 3 markers&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">])</span>

<span class="n">elemnum</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># choose which element to plot</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">waveforms</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">elemnum</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#e1cb66&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m1s</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">elemnum</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#FF4500&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m2s</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">elemnum</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#FF8C00&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">waveforms</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">elemnum</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#800080&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m1s</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">elemnum</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#6A5ACD&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m2s</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">elemnum</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#EE82EE&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="getting-them-there-via-an-awg-file">
<h3>GETTING THEM THERE VIA AN .AWG FILE<a class="headerlink" href="#getting-them-there-via-an-awg-file" title="Permalink to this headline">¶</a></h3>
<p>The fastest way to transfer waveforms to the AWG is by using an .awg
file.</p>
<p>In addition to waveforms and markers, me must specify sequencing options
for each sequence element.</p>
<p>In this example notebook, we just put in some random numbers.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Sequencing options</span>

<span class="c1"># number of repetitions</span>
<span class="n">nreps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">noofseqelems</span><span class="p">)]</span>
<span class="c1"># Wait trigger (0 or 1)</span>
<span class="n">trig_waits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">noofseqelems</span>
<span class="c1"># Goto state</span>
<span class="n">goto_states</span> <span class="o">=</span> <span class="p">[((</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">noofseqelems</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">noofseqelems</span><span class="p">)]</span>
<span class="c1">#goto_states = [0]*noofseqelems</span>
<span class="c1"># Event jump</span>
<span class="n">jump_tos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">noofseqelems</span>
</pre></div>
</div>
<p>Then all the magic happens in the following function call (type
help(make_send_and_load_awg_file) to see all possible input
parameters):</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">awg1</span><span class="o">.</span><span class="n">make_send_and_load_awg_file</span><span class="p">(</span><span class="n">waveforms</span><span class="p">,</span> <span class="n">m1s</span><span class="p">,</span> <span class="n">m2s</span><span class="p">,</span>
                                 <span class="n">nreps</span><span class="p">,</span> <span class="n">trig_waits</span><span class="p">,</span>
                                 <span class="n">goto_states</span><span class="p">,</span> <span class="n">jump_tos</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>In order to build a local library of pulse sequences, one may generate
and locally save the .awg file.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;test_awg_file.awg&#39;</span><span class="p">)</span>
<span class="n">awgfile</span> <span class="o">=</span> <span class="n">awg1</span><span class="o">.</span><span class="n">make_and_save_awg_file</span><span class="p">(</span><span class="n">waveforms</span><span class="p">,</span> <span class="n">m1s</span><span class="p">,</span> <span class="n">m2s</span><span class="p">,</span> <span class="n">nreps</span><span class="p">,</span> <span class="n">trig_waits</span><span class="p">,</span> <span class="n">goto_states</span><span class="p">,</span>
                                      <span class="n">jump_tos</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">filename</span><span class="o">=</span><span class="n">filepath</span><span class="p">)</span>
</pre></div>
</div>
<p>A saved .awg file may be loaded back into memrory using the helper
function <code class="docutils literal"><span class="pre">parse_awg_file</span></code>, which returns a tuple containing: * A
tuple matching the call signature of <code class="docutils literal"><span class="pre">awg1.make_and_save_awg_file</span></code>
(see below) * A dictionary with all the instrument settings of the .awg
file</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">callsig</span><span class="p">,</span> <span class="n">instdict</span><span class="p">)</span> <span class="o">=</span> <span class="n">parse_awg_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<span class="p">(</span><span class="n">waveforms</span><span class="p">,</span> <span class="n">m1s</span><span class="p">,</span> <span class="n">m2s</span><span class="p">,</span> <span class="n">nreps</span><span class="p">,</span> <span class="n">trig_waits</span><span class="p">,</span> <span class="n">goto_states</span><span class="p">,</span> <span class="n">jump_tos</span><span class="p">,</span> <span class="n">channels</span><span class="p">)</span> <span class="o">=</span> <span class="n">callsig</span>
</pre></div>
</div>
<p>To see how everything fits together, we may now upload the file we just
parsed.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">awg1</span><span class="o">.</span><span class="n">make_send_and_load_awg_file</span><span class="p">(</span><span class="n">waveforms</span><span class="p">,</span> <span class="n">m1s</span><span class="p">,</span> <span class="n">m2s</span><span class="p">,</span>
                                 <span class="n">nreps</span><span class="p">,</span> <span class="n">trig_waits</span><span class="p">,</span>
                                 <span class="n">goto_states</span><span class="p">,</span> <span class="n">jump_tos</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="n">channels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="getting-them-there-by-sending-waveforms-to-list">
<h3>GETTING THEM THERE BY SENDING WAVEFORMS TO LIST<a class="headerlink" href="#getting-them-there-by-sending-waveforms-to-list" title="Permalink to this headline">¶</a></h3>
<p>An alternative way to transfer waveforms to the AWG is by sending them
directly to the waveform list and then putting them into the sequencer.
This method is more explicit, but slower for large waveforms.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="c1"># First clear up the waveform list and empty the sequencer</span>
<span class="n">awg1</span><span class="o">.</span><span class="n">delete_all_waveforms_from_list</span><span class="p">()</span>
<span class="c1"># Then set the sequence length to the correct number lest not all sequence elements get uploaded</span>
<span class="n">awg1</span><span class="o">.</span><span class="n">sequence_length</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">noofseqelems</span><span class="p">)</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="c1">#Then transfer the waveforms to the list...</span>
<span class="k">for</span> <span class="n">elnum</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">noofseqelems</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">chnum</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">wfmname</span> <span class="o">=</span> <span class="s1">&#39;wfm</span><span class="si">{:03d}</span><span class="s1">ch</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">elnum</span><span class="p">,</span> <span class="n">chnum</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">awg1</span><span class="o">.</span><span class="n">send_waveform_to_list</span><span class="p">(</span><span class="n">waveforms</span><span class="p">[</span><span class="n">chnum</span><span class="p">][</span><span class="n">elnum</span><span class="p">],</span> <span class="n">m1s</span><span class="p">[</span><span class="n">chnum</span><span class="p">][</span><span class="n">elnum</span><span class="p">],</span> <span class="n">m2s</span><span class="p">[</span><span class="n">chnum</span><span class="p">][</span><span class="n">elnum</span><span class="p">],</span> <span class="n">wfmname</span><span class="p">)</span>
<span class="c1">#...upload them to the sequencer...</span>
<span class="k">for</span> <span class="n">elnum</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">noofseqelems</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">chnum</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">wfmname</span> <span class="o">=</span> <span class="s1">&#39;wfm</span><span class="si">{:03d}</span><span class="s1">ch</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">elnum</span><span class="p">,</span> <span class="n">chnum</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">awg1</span><span class="o">.</span><span class="n">set_sqel_waveform</span><span class="p">(</span><span class="n">wfmname</span><span class="p">,</span> <span class="n">chnum</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">elnum</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#...and set the sequence elements setting</span>
<span class="k">for</span> <span class="n">elnum</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">noofseqelems</span><span class="p">):</span>
    <span class="n">awg1</span><span class="o">.</span><span class="n">set_sqel_goto_target_index</span><span class="p">(</span><span class="n">elnum</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">goto_states</span><span class="p">[</span><span class="n">elnum</span><span class="p">])</span>
    <span class="n">awg1</span><span class="o">.</span><span class="n">set_sqel_loopcnt</span><span class="p">(</span><span class="n">nreps</span><span class="p">[</span><span class="n">elnum</span><span class="p">],</span> <span class="n">elnum</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">awg1</span><span class="o">.</span><span class="n">set_sqel_trigger_wait</span><span class="p">(</span><span class="n">elnum</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">trig_waits</span><span class="p">[</span><span class="n">elnum</span><span class="p">])</span>
    <span class="n">awg1</span><span class="o">.</span><span class="n">set_sqel_event_target_index</span><span class="p">(</span><span class="n">elnum</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">jump_tos</span><span class="p">[</span><span class="n">elnum</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-the-awg-in-lazy-mode">
<h2>Running the AWG in “lazy” mode<a class="headerlink" href="#running-the-awg-in-lazy-mode" title="Permalink to this headline">¶</a></h2>
<p>In “lazy” mode, the AWG continuously outputs a specific sequence element
until the user forces a jump to another element (as opposed to running
through the sequence in a particular predefined order). On the hardware
side, this is still done by running the AWG in <code class="docutils literal"><span class="pre">sequence</span></code> mode, but
with all sequence elements having their sequencer options set to
infinite repetitions.</p>
<p>Below we assume that the above awg file has been loaded into the
sequencer.</p>
<p>The parameter controlling the sequence element currently being run is
called <code class="docutils literal"><span class="pre">sequence_pos</span></code>. Note that this is also accesible in non-lazy
mode, although in that mode its return value quickly becomes obsolete.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">sleep</span>

<span class="c1"># Set the corresponding sequencing options</span>
<span class="k">for</span> <span class="n">seq_elem</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">awg1</span><span class="o">.</span><span class="n">sequence_length</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">awg1</span><span class="o">.</span><span class="n">set_sqel_loopcnt_to_inf</span><span class="p">(</span><span class="n">seq_elem</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Now jump around in a &quot;lazy&quot; way</span>
<span class="n">awg1</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">awg1</span><span class="o">.</span><span class="n">sequence_pos</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">awg1</span><span class="o">.</span><span class="n">sequence_pos</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">awg1</span><span class="o">.</span><span class="n">sequence_pos</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">awg1</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p>For completeness, we note that infinite repetitions of each sequence
element can be achieved by setting the number of repetitions to 0 when
casting the awg file.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="c1"># number of repetitions</span>
<span class="n">nreps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">noofseqelems</span><span class="p">)]</span>  <span class="c1"># Infinite repetitions</span>

<span class="c1"># It doesn&#39;t matter what we set the next values to, but the lists need to exist and have the right length</span>

<span class="c1"># Wait trigger (0 or 1)</span>
<span class="n">trig_waits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">noofseqelems</span>
<span class="c1"># Goto state</span>
<span class="n">goto_states</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">noofseqelems</span>
<span class="c1"># Event jump</span>
<span class="n">jump_tos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">noofseqelems</span>

<span class="n">awg1</span><span class="o">.</span><span class="n">make_send_and_load_awg_file</span><span class="p">(</span><span class="n">waveforms</span><span class="p">,</span> <span class="n">m1s</span><span class="p">,</span> <span class="n">m2s</span><span class="p">,</span>
                                 <span class="n">nreps</span><span class="p">,</span> <span class="n">trig_waits</span><span class="p">,</span>
                                 <span class="n">goto_states</span><span class="p">,</span> <span class="n">jump_tos</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>Finally, close down the instrument.</p>
<div class="code ipython3 highlight-default"><div class="highlight"><pre><span></span><span class="n">awg1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Qcodes example with Triton.html" class="btn btn-neutral float-right" title="Qcodes example with Triton" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Qcodes example with TPS2012.html" class="btn btn-neutral" title="QCoDeS Example with Tektronix TPS2012" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1.7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>